/* ═══ RESPONSIVE + NEW UI v23 ═══ */
html{-webkit-text-size-adjust:100%;text-size-adjust:100%;}
html,body{overflow-x:hidden;max-width:100%;}
*,*::before,*::after{box-sizing:border-box;min-width:0;}
@supports(padding-top:env(safe-area-inset-top)){
  .music-bar{padding-left:max(14px,env(safe-area-inset-left))!important;padding-right:max(14px,env(safe-area-inset-right))!important;}
  .mobile-nav{padding-left:env(safe-area-inset-left)!important;padding-right:env(safe-area-inset-right)!important;}
}
/* ════════════════════════════════════════════════
   LIB-ITEM — estrutura base (desktop + mobile)
════════════════════════════════════════════════ */
/* ══════════════════════════════════════
   LIB-ITEM-SET — card de conjunto
══════════════════════════════════════ */
.lib-item-set {
  display: flex;
  flex-direction: column;
  padding: 14px 16px;
  background: var(--bg2);
  border: 1px solid var(--border);
  border-radius: var(--radius-sm);
  transition: border-color .18s, background .18s;
  gap: 0;
}
.lib-item-set:hover { border-color: var(--border2); background: var(--surface); }

/* Linha principal: chev | info | (ícones + iniciar) */
.lib-item-top {
  display: flex;
  align-items: center;
  gap: 10px;
  width: 100%;
}
.lib-chev-btn {
  background: none;
  border: 1px solid var(--border2);
  border-radius: 5px;
  width: 26px; height: 26px;
  display: flex; align-items: center; justify-content: center;
  cursor: pointer; color: var(--text3); font-size: 10px;
  flex-shrink: 0; transition: all .15s; transform: rotate(-90deg);
  touch-action: manipulation;
}
.lib-chev-btn:hover { border-color: var(--gold-d); color: var(--gold); }
.lib-item-top .lib-info { flex: 1; min-width: 0; overflow: hidden; }
.lib-item-top .lib-name { font-size: 15px; font-weight: 700; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.lib-item-top .lib-meta { font-size: 10px; color: var(--text3); margin-top: 2px; display: flex; flex-wrap: wrap; gap: 4px; align-items: center; line-height: 1.5; }

/* Coluna direita: ícones empilhados sobre INICIAR */
.lib-item-right {
  display: flex;
  flex-direction: column;
  align-items: flex-end;
  gap: 6px;
  flex-shrink: 0;
}
.lib-item-right .lib-icon-row { display: flex; gap: 5px; align-items: center; }
.lib-item-right .lib-start-btn { width: 100%; justify-content: center; }

/* Search bar */
.lib-search-bar { margin-bottom: 14px; display: flex; flex-direction: column; gap: 6px; }
.lib-search-row  { display: flex; gap: 6px; align-items: center; }
.lib-search-input {
  flex: 1; min-width: 0;
  padding: 8px 10px;
  border-radius: 8px; border: 1px solid var(--border2);
  background: var(--surface3); color: var(--text);
  font-size: 12px; font-family: var(--font-body); outline: none;
}
.lib-set-filter {
  padding: 8px 8px; border-radius: 8px; border: 1px solid var(--border2);
  background: var(--surface3); color: var(--text);
  font-size: 12px; font-family: var(--font-body); outline: none; cursor: pointer;
  max-width: 140px;
}
.lib-clear-btn {
  align-self: flex-start; padding: 5px 12px; border-radius: 8px;
  border: 1px solid var(--border2); background: transparent;
  color: var(--text3); font-size: 11px; cursor: pointer; transition: all .15s;
}
.lib-clear-btn:hover { border-color: var(--red); color: var(--red); }

/* ════════════════════════════════════════════════
   MOBILE — iPhone (≤ 600px)
════════════════════════════════════════════════ */
@media(max-width:600px){

  /* ── Base resets ── */
  *,*::before,*::after { -webkit-tap-highlight-color: transparent; }
  body { padding-top: 54px; -webkit-text-size-adjust: 100%; }
  .wrap { padding: 16px 13px calc(72px + env(safe-area-inset-bottom)) !important; }

  /* ── Topbar ── */
  .music-bar { height: 54px !important; padding: 0 10px !important; gap: 6px !important; }
  .mbar-icon,.mbar-track,.mbar-vol,.mbar-input,.mbar-load,.mbar-time { display: none !important; }
  .mbar-btn { width: 38px !important; height: 38px !important; font-size: 15px !important; flex-shrink: 0 !important; }
  .mbar-chrono-mob { display: block; margin-left: auto; flex-shrink: 0; font-family: var(--font-mono); font-size: 13px; font-weight: 700; color: var(--gold); letter-spacing: .08em; }

  /* ── Tabs → mobile nav ── */
  .tabs { display: none !important; }

  /* ── Cards ── */
  .card, .q-card { padding: 16px 14px !important; border-radius: 12px !important; }
  .site-title { font-size: clamp(1.4rem, 7vw, 2rem) !important; }
  .site-header { margin-bottom: 20px !important; }

  /* ── Biblioteca — lib-item-set ── */
  .lib-item-set { padding: 12px 13px !important; }
  .lib-item-top { gap: 8px !important; align-items: flex-start !important; }
  .lib-chev-btn { width: 26px !important; height: 26px !important; margin-top: 2px !important; }
  .lib-item-top .lib-name { font-size: 14px !important; }
  .lib-item-top .lib-meta { font-size: 10px !important; gap: 3px !important; }
  .lib-item-right { gap: 5px !important; }
  .lib-item-right .lib-icon-row { gap: 4px !important; }
  .lib-icon-btn { width: 30px !important; height: 30px !important; font-size: 13px !important; border-radius: 7px !important; }
  .lib-start-btn { padding: 0 10px !important; height: 30px !important; min-height: 30px !important; font-size: 9.5px !important; letter-spacing: .08em !important; white-space: nowrap !important; }

  /* ── Search bar ── */
  .lib-search-bar { gap: 6px !important; margin-bottom: 14px !important; }
  .lib-search-row { flex-wrap: nowrap !important; gap: 6px !important; }
  .lib-search-input { font-size: 13px !important; padding: 8px 10px !important; }
  .lib-set-filter { font-size: 11px !important; padding: 8px 8px !important; max-width: 130px !important; }
  .lib-clear-btn { font-size: 11px !important; padding: 6px 12px !important; }

  /* ── Export bar (conjuntos expandidos) ── */
  .set-export-bar { gap: 5px !important; padding: 8px 0 10px !important; flex-wrap: nowrap !important; overflow-x: auto !important; scrollbar-width: none !important; -webkit-overflow-scrolling: touch !important; }
  .set-export-bar::-webkit-scrollbar { display: none !important; }
  .set-export-btn { font-size: 10px !important; padding: 5px 10px !important; border-radius: 14px !important; min-height: 30px !important; white-space: nowrap !important; flex-shrink: 0 !important; }

  /* ── Sub-tabs ── */
  .lib-sub-tabs { gap: 4px !important; padding: 4px !important; }
  .lib-sub-tab  { font-size: 9px !important; padding: 8px 8px !important; }

  /* ── Quiz card ── */
  .q-num { font-size: 10px !important; }
  .q-text { font-size: 15px !important; line-height: 1.65 !important; }
  .opt-btn { padding: 13px 12px !important; min-height: 50px !important; font-size: 13.5px !important; }
  .opt-letter { width: 26px !important; height: 26px !important; font-size: 11px !important; flex-shrink: 0 !important; }
  .opt-strike-x { width: 26px !important; height: 26px !important; font-size: 12px !important; right: 8px !important; }

  /* ── Botões flutuantes no card ── */
  .q-edit-toggle { top: 10px !important; right: 10px !important; width: 26px !important; height: 26px !important; font-size: 12px !important; }
  .doubt-btn     { top: 10px !important; right: 44px !important; width: 30px !important; height: 30px !important; font-size: 14px !important; }
  .qe-export-btn { top: 10px !important; right: 82px !important; width: 30px !important; height: 30px !important; font-size: 14px !important; }

  /* ── Export panel → bottom sheet ── */
  .export-panel {
    position: fixed !important;
    top: auto !important;
    bottom: calc(66px + env(safe-area-inset-bottom)) !important;
    left: 10px !important; right: 10px !important;
    min-width: unset !important; max-width: unset !important;
    border-radius: 16px !important;
    z-index: 250 !important;
  }
  .export-grid { grid-template-columns: 1fr 1fr 1fr !important; gap: 6px !important; }
  .export-btn  { min-height: 62px !important; padding: 8px 4px !important; }
  .export-btn-icon { font-size: 18px !important; }
  .export-btn-label { font-size: 9px !important; }

  /* ── Nav dots ── */
  .q-nav-wrap { padding: 8px 8px !important; flex-wrap: wrap !important; }
  .q-dot { width: 28px !important; height: 28px !important; font-size: 8.5px !important; }

  /* ── Toolbar quiz ── */
  .quiz-toolbar { gap: 5px !important; padding: 8px 10px !important; overflow-x: auto !important; flex-wrap: nowrap !important; scrollbar-width: none !important; -webkit-overflow-scrolling: touch !important; }
  .quiz-toolbar::-webkit-scrollbar { display: none !important; }
  .tool-btn { width: 36px !important; height: 36px !important; font-size: 14px !important; flex-shrink: 0 !important; }

  /* ── Botões gerais ── */
  .btn,.btn-primary,.btn-secondary,.btn-danger,.btn-green { min-height: 46px !important; font-size: 11px !important; }
  .btn-row .btn { flex: 1 1 calc(50% - 4px) !important; justify-content: center !important; min-height: 44px !important; font-size: 10px !important; }
  .nav-row .btn { flex: 1 1 calc(50% - 4px) !important; justify-content: center !important; }

  /* ── Score / result ── */
  .res-grid { gap: 7px !important; }
  .res-cell { padding: 12px 8px !important; }
  .res-cell .val { font-size: 1.7rem !important; }

  /* ── Análise expand ── */
  .expl-panel { left: 0 !important; right: 0 !important; bottom: 0 !important; border-radius: 18px 18px 0 0 !important; max-height: 85vh !important; }
  .expl-body.open .expl-body-inner { padding: 16px !important; }

  /* ── Confirm ── */
  .confirm-bar { flex-wrap: wrap !important; gap: 8px !important; padding: 10px 12px !important; }
  .confirm-bar-ok, .confirm-bar-cancel { flex: 1 !important; min-width: 100px !important; min-height: 44px !important; justify-content: center !important; }

  /* ── Dúvidas ── */
  .doubt-accordion-header { padding: 10px 12px !important; }
  .doubt-accordion-name   { font-size: 12.5px !important; }
  .doubt-accordion-body   { padding: 4px 10px 14px !important; }
  .doubt-copy-all-btn     { display: none !important; }
  .dq-btn { font-size: 10px !important; padding: 5px 10px !important; }

  /* ── Filtros de conjunto ── */
  .set-analysis-filter { overflow-x: auto !important; flex-wrap: nowrap !important; scrollbar-width: none !important; }
  .set-analysis-filter::-webkit-scrollbar { display: none !important; }
  .set-filter-btn { flex-shrink: 0 !important; font-size: 10px !important; padding: 5px 10px !important; }

  /* ── Modal ── */
  .modal-box { padding: 22px 18px !important; border-radius: 14px !important; margin: 14px !important; }

  /* ── Tipografia e cronômetro: gerenciados pelo mob-sheet ── */

  /* ── Nav mobile ── */
  .mobile-nav { position: fixed; bottom: 0; left: 0; right: 0; height: calc(58px + env(safe-area-inset-bottom)); padding-bottom: env(safe-area-inset-bottom); background: rgba(14,12,10,.97); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); border-top: 1px solid var(--border2); z-index: 150; display: flex !important; align-items: stretch; }
  .mobile-nav-btn { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 3px; background: none; border: none; cursor: pointer; color: var(--text4); padding: 6px 2px 4px; touch-action: manipulation; transition: color .18s, transform .12s; position: relative; }
  .mobile-nav-btn:active { transform: scale(.92); }
  .mobile-nav-btn.active { color: var(--text); }
  .mobile-nav-btn.active::after { content: ''; position: absolute; top: 0; left: 20%; right: 20%; height: 2px; background: linear-gradient(90deg,var(--gold-d),var(--gold)); border-radius: 0 0 2px 2px; }
  .mnav-icon { font-size: 20px !important; line-height: 1; display: block; filter: grayscale(.3); transition: filter .18s, transform .18s; }
  .mobile-nav-btn.active .mnav-icon { filter: none; transform: scale(1.08); }
  .mnav-aa { font-family: var(--font-display); font-size: 16px; font-weight: 700; line-height: 1; color: inherit; }
  .mnav-lbl { font-family: var(--font-mono); font-size: 8px !important; font-weight: 600; letter-spacing: .06em; text-transform: uppercase; line-height: 1; }

  /* ── Touch general ── */
  button,a,.opt-btn,.tab-btn,.q-dot,.tool-btn,.lib-icon-btn { touch-action: manipulation !important; }
}

@media(max-width:380px){
  .lib-icon-btn { width: 30px !important; height: 30px !important; font-size: 13px !important; }
  .lib-start-btn { font-size: 9px !important; padding: 0 8px !important; }
  .site-title { font-size: clamp(1.3rem, 7vw, 1.8rem) !important; }
}

/* ════════════════════════════════════════════════
   TABLET — Galaxy Tab S10 FE+ (601 – 1024px)
════════════════════════════════════════════════ */
@media(min-width:601px) and (max-width:1024px){
  body { padding-top: 64px; }
  .wrap { padding: 24px 24px 48px !important; max-width: 100% !important; }
  .card, .q-card { padding: 28px 24px !important; }
  .mobile-nav { display: none !important; }

  .music-bar { height: 64px !important; padding: 0 20px !important; gap: 10px !important; }
  .mbar-vol  { display: none !important; }
  .mbar-btn  { width: 44px !important; height: 44px !important; font-size: 17px !important; }

  .tabs { display: flex !important; overflow-x: auto !important; flex-wrap: nowrap !important; -webkit-overflow-scrolling: touch !important; scrollbar-width: none !important; }
  .tabs::-webkit-scrollbar { display: none !important; }
  .tab-btn { font-size: 11.5px !important; padding: 10px 18px !important; white-space: nowrap !important; flex-shrink: 0 !important; min-height: 40px !important; }

  /* lib-item tablet — horizontal compacto */
  .lib-item-set { padding: 16px 20px !important; }
  .lib-name { font-size: 15px !important; }
  .lib-meta { font-size: 11px !important; }
  .lib-icon-btn { width: 38px !important; height: 38px !important; font-size: 15px !important; }
  .lib-start-btn { padding: 8px 18px !important; font-size: 11px !important; }
  .lib-item-actions { margin-top: 10px !important; padding-top: 10px !important; }

  .q-text { font-size: 17px !important; line-height: 1.7 !important; }
  .opt-btn { padding: 16px 18px !important; min-height: 56px !important; font-size: 15px !important; }
  .q-dot { width: 34px !important; height: 34px !important; font-size: 10px !important; }
  .tool-btn { width: 42px !important; height: 42px !important; font-size: 16px !important; }

  .q-edit-toggle { top: 12px !important; right: 12px !important; }
  .doubt-btn     { top: 12px !important; right: 52px !important; }
  .qe-export-btn { top: 12px !important; right: 96px !important; }

  .export-panel { min-width: 340px !important; }
  .set-export-btn { font-size: 12px !important; padding: 6px 14px !important; }

  button,a,.opt-btn,.tab-btn,.q-dot,.tool-btn,.lib-icon-btn { touch-action: manipulation !important; -webkit-tap-highlight-color: transparent !important; }
}

/* ── Tablet landscape / desktop ── */
@media(min-width:1025px) and (max-width:1200px){ .wrap{ max-width: 880px !important; padding-left: 28px !important; padding-right: 28px !important; } }
@media(min-width:1201px) and (max-width:1440px){ .wrap{ max-width: 960px !important; } }
/* ══════════════════════════════════════
   GEMINI ESSAY RESULT
══════════════════════════════════════ */
@keyframes geminiPop {
  0%   { opacity:0; transform:scale(.92) translateY(10px); }
  60%  { transform:scale(1.02) translateY(-2px); }
  100% { opacity:1; transform:scale(1) translateY(0); }
}
@keyframes correctPulse {
  0%,100% { box-shadow: 0 0 0 0 rgba(78,203,141,0); }
  50%      { box-shadow: 0 0 0 12px rgba(78,203,141,.18); }
}
@keyframes spinnerRot {
  to { transform: rotate(360deg); }
}

.gemini-loading {
  display: flex; align-items: center; gap: 10px;
  padding: 14px 16px; margin-top: 12px;
  border-radius: 10px;
  background: var(--surface3);
  border: 1px solid var(--border2);
  font-family: var(--font-mono); font-size: 12px; color: var(--text3);
  letter-spacing: .05em;
}
.gemini-spinner {
  width: 16px; height: 16px; flex-shrink: 0;
  border: 2px solid var(--border2);
  border-top-color: var(--violet);
  border-radius: 50%;
  animation: spinnerRot .8s linear infinite;
  display: inline-block;
}

.gemini-result {
  margin-top: 14px;
  border-radius: 14px;
  padding: 18px 20px;
  animation: geminiPop .45s cubic-bezier(.22,1,.36,1) both;
}
.gemini-result.correto {
  background: rgba(78,203,141,.08);
  border: 1.5px solid rgba(78,203,141,.35);
  animation: geminiPop .45s cubic-bezier(.22,1,.36,1) both, correctPulse 1.2s ease 0.45s 2;
}
.gemini-result.parcial {
  background: rgba(251,191,36,.07);
  border: 1.5px solid rgba(251,191,36,.3);
}
.gemini-result.incorreto {
  background: rgba(240,96,96,.07);
  border: 1.5px solid rgba(240,96,96,.28);
}
.gemini-result.erro, .gemini-result.sem-gabarito {
  background: var(--surface3);
  border: 1px solid var(--border2);
}

.gemini-verdict-badge {
  display: inline-flex; align-items: center; gap: 6px;
  font-family: var(--font-mono); font-weight: 700;
  font-size: 13px; letter-spacing: .12em; text-transform: uppercase;
  margin-bottom: 10px;
}
.gemini-verdict-badge.correto { color: var(--green); }
.gemini-verdict-badge.parcial { color: #f5c842; }
.gemini-verdict-badge.incorreto { color: var(--coral); }

.gemini-check {
  font-size: 18px; font-weight: 900;
  animation: geminiPop .3s ease .4s both;
  display: inline-block;
}

.gemini-score {
  font-family: var(--font-display); font-size: 2.4rem; font-weight: 700;
  line-height: 1; margin-bottom: 10px;
  color: var(--text);
}
.gemini-score span { font-size: 1rem; color: var(--text3); font-weight: 400; }
.gemini-result.correto .gemini-score { color: var(--green); }
.gemini-result.parcial .gemini-score { color: #f5c842; }
.gemini-result.incorreto .gemini-score { color: var(--coral); }

.gemini-feedback {
  font-size: 14px; line-height: 1.65; color: var(--text2);
  margin-bottom: 10px;
}
.gemini-section {
  margin-top: 10px;
  padding: 10px 13px;
  border-radius: 8px;
  font-size: 13px; line-height: 1.6; color: var(--text2);
}
.gemini-section.acertos { background: rgba(78,203,141,.07); border-left: 2px solid var(--green); }
.gemini-section.divergencias { background: rgba(240,96,96,.06); border-left: 2px solid var(--coral); }
.gemini-section.dica { background: rgba(232,184,75,.07); border-left: 2px solid var(--gold-d); }
.gemini-section-lbl {
  display: block;
  font-family: var(--font-mono); font-size: 9px; font-weight: 600;
  letter-spacing: .16em; text-transform: uppercase;
  color: var(--text3); margin-bottom: 5px;
}
.gemini-gabarito {
  margin-top: 12px; padding: 12px 14px;
  border-radius: 8px;
  background: var(--surface3);
  border: 1px solid var(--border);
  font-size: 13px; line-height: 1.65; color: var(--text2);
}

@media(max-width:600px){
  .gemini-result { padding: 14px 14px !important; border-radius: 12px !important; }
  .gemini-score { font-size: 2rem !important; }
  .gemini-verdict-badge { font-size: 11px !important; }
}
══════════════════════════════════════ */
.nqe-box {
  max-width: 520px; width: 100%;
  max-height: 88vh; overflow-y: auto;
  padding: 28px 28px 24px;
}
.nqe-field-label {
  font-family: var(--font-mono);
  font-size: 9px; font-weight: 600;
  letter-spacing: 0.18em; text-transform: uppercase;
  color: var(--text3); margin-bottom: 6px;
}
.nqe-required { color: var(--coral); }
.nqe-type-row { display: flex; gap: 8px; margin-bottom: 18px; }
.nqe-type-btn {
  flex: 1; padding: 10px 12px;
  border-radius: 10px;
  border: 1px solid var(--border2);
  background: var(--surface3);
  color: var(--text2);
  font-family: var(--font-mono);
  font-size: 11px; font-weight: 500; letter-spacing: 0.05em;
  cursor: pointer; transition: all .15s;
  touch-action: manipulation;
}
.nqe-type-btn.active {
  border-color: var(--violet);
  background: rgba(192,132,252,.12);
  color: var(--violet);
}
.nqe-textarea {
  width: 100%; box-sizing: border-box;
  padding: 12px 14px;
  border-radius: 10px;
  border: 1px solid var(--border2);
  background: var(--surface3);
  color: var(--text);
  font-family: var(--font-body);
  font-size: 14px; line-height: 1.6;
  resize: vertical; outline: none;
  transition: border-color .18s;
}
.nqe-textarea:focus { border-color: var(--violet); }
.nqe-alt-row {
  display: flex; align-items: center; gap: 8px;
  margin-bottom: 7px;
}
.nqe-correct-dot {
  width: 32px; height: 32px; flex-shrink: 0;
  border-radius: 50%;
  border: 1px solid var(--border2);
  background: var(--surface3);
  color: var(--text3);
  font-family: var(--font-mono);
  font-size: 12px; font-weight: 700;
  cursor: pointer; transition: all .15s;
  display: flex; align-items: center; justify-content: center;
  touch-action: manipulation;
}
.nqe-correct-dot.selected {
  border-color: var(--gold-d);
  background: var(--gold-bg);
  color: var(--gold);
  box-shadow: 0 0 0 2px rgba(232,184,75,.2);
}
.nqe-alt-input {
  flex: 1; padding: 8px 12px;
  border-radius: 8px;
  border: 1px solid var(--border2);
  background: var(--surface3);
  color: var(--text);
  font-family: var(--font-body);
  font-size: 13px; outline: none;
  transition: border-color .18s;
}
.nqe-alt-input:focus { border-color: var(--gold-d); }
.nqe-correct-display {
  font-family: var(--font-mono);
  font-size: 11px; color: var(--text3);
  padding: 6px 0 0;
}

@media(max-width:600px) {
  .nqe-box { padding: 20px 16px 18px !important; max-height: 92vh !important; }
  .nqe-type-btn { font-size: 10px !important; padding: 9px 8px !important; }
  .essay-input { min-height: 130px !important; font-size: 14px !important; }
  .essay-confirm-btn { width: 100% !important; justify-content: center !important; }
}
══════════════════════════════════════ */
.essay-wrap {
  display: flex; flex-direction: column; gap: 10px;
  margin-top: 4px;
}
.essay-label {
  font-family: var(--font-mono);
  font-size: 10px; letter-spacing: 0.16em; text-transform: uppercase;
  color: var(--text3);
}
.essay-input {
  width: 100%; min-height: 160px;
  padding: 14px 16px;
  border-radius: 10px;
  border: 1px solid var(--border2);
  background: var(--surface3);
  color: var(--text);
  font-family: var(--font-body);
  font-size: 15px;
  line-height: 1.65;
  resize: vertical;
  outline: none;
  transition: border-color .18s;
  box-sizing: border-box;
}
.essay-input:focus { border-color: var(--gold-d); }
.essay-input:disabled {
  opacity: 0.8;
  border-color: var(--border);
  background: var(--bg2);
  cursor: default;
}
.essay-actions { display: flex; justify-content: flex-end; }
.essay-confirm-btn { min-height: 44px; padding: 10px 24px; }
.essay-answered-badge {
  font-family: var(--font-mono);
  font-size: 11px; letter-spacing: 0.1em;
  color: var(--green);
  padding: 8px 12px;
  border: 1px solid rgba(78,203,141,.25);
  border-radius: 8px;
  background: rgba(78,203,141,.07);
  display: inline-flex; align-items: center; gap: 6px;
}
.feedback-badge.essay-fb {
  background: rgba(232,184,75,.09);
  border-color: rgba(232,184,75,.3);
  color: var(--gold);
}
/* badge no card de questão dissertativa na biblioteca */
.essay-type-badge {
  font-family: var(--font-mono);
  font-size: 9px; font-weight: 600;
  letter-spacing: 0.1em; text-transform: uppercase;
  color: var(--violet);
  background: rgba(192,132,252,.1);
  border: 1px solid rgba(192,132,252,.25);
  border-radius: 4px;
  padding: 1px 7px;
}
/* Preview da resposta dissertativa no resultado do quiz */
.essay-review-answer {
  margin-top: 8px; padding: 12px 14px;
  border-radius: 8px;
  border-left: 2px solid var(--gold-d);
  background: var(--surface3);
  font-size: 13px; line-height: 1.6; color: var(--text2);
  white-space: pre-wrap; word-break: break-word;
}

/* ── New UI ── */
.doubt-accordion{border-radius:10px;margin-bottom:14px;overflow:hidden;}
.doubt-accordion-header{display:flex;align-items:center;justify-content:space-between;padding:13px 16px;cursor:pointer;transition:background 0.18s;user-select:none;gap:8px;}
.doubt-accordion-left{display:flex;align-items:center;gap:10px;flex:1;min-width:0;}
.doubt-accordion-name{font-family:var(--font-body);font-size:13.5px;font-weight:600;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;}
.doubt-accordion-right{display:flex;align-items:center;gap:6px;flex-shrink:0;}
.doubt-accordion-count{font-size:11px;font-family:var(--font-mono);border-radius:20px;padding:2px 10px;white-space:nowrap;font-weight:500;border:1px solid;}
.doubt-accordion-review{font-size:11px;font-weight:600;border-radius:6px;padding:4px 11px;cursor:pointer;border:1px solid;background:transparent;transition:all 0.15s;white-space:nowrap;}
.doubt-accordion-chevron{font-size:10px;opacity:0.4;transition:transform 0.22s;flex-shrink:0;margin-left:2px;}
.doubt-accordion-chevron.open{transform:rotate(180deg);opacity:0.8;}
.doubt-accordion-body{display:none;padding:4px 14px 16px;}
.doubt-accordion-body.open{display:block;}
.doubt-q-text,.incomplete-q-text{font-size:13px!important;font-family:var(--font-body)!important;line-height:1.6!important;color:var(--text)!important;font-weight:400!important;margin-bottom:0!important;white-space:normal!important;overflow:visible!important;}
.doubt-q-opts{margin-top:10px;display:flex;flex-direction:column;gap:5px;}
.doubt-q-opt{font-size:12.5px!important;color:var(--text2)!important;padding:6px 10px;border-radius:6px;background:rgba(255,255,255,0.03);border:1px solid var(--border);line-height:1.5;}
.doubt-q-opt .ltr{font-weight:700!important;font-family:var(--font-mono)!important;color:var(--text)!important;margin-right:7px;}
.doubt-copy-btn{font-size:11px;padding:3px 10px;border-radius:6px;border:1px solid var(--border2);background:transparent;color:var(--text2);cursor:pointer;white-space:nowrap;}
.doubt-copy-btn:hover{border-color:var(--gold);color:var(--gold);}
.doubt-copy-all-btn{display:inline-flex;align-items:center;font-size:11px;padding:2px 10px;border-radius:20px;border:1px solid var(--border2);background:var(--surface2);color:var(--text2);cursor:pointer;white-space:nowrap;}
.doubt-copy-all-btn:hover{border-color:rgba(240,184,74,0.50);color:var(--gold2);}
.doubt-search-input{width:100%;box-sizing:border-box;padding:9px 14px;border-radius:8px;border:1px solid var(--border2);background:rgba(5,5,7,0.55);color:var(--text);font-size:13px;margin-bottom:14px;outline:none;}
.doubt-search-input:focus{border-color:rgba(240,184,74,0.4);}
.alt-expl-section{display:flex;flex-direction:column;gap:10px;}
.alt-expl-section-label{font-family:var(--font-mono);font-size:10px;color:var(--text3);letter-spacing:0.12em;text-transform:uppercase;padding-bottom:6px;border-bottom:1px solid var(--border);}
.alt-expl-row{display:flex;flex-direction:column;gap:3px;}
.alt-expl-row-header{display:flex;align-items:center;gap:7px;margin-bottom:2px;}
.alt-expl-badge{display:inline-flex;align-items:center;justify-content:center;width:22px;height:22px;border-radius:5px;font-family:var(--font-mono);font-size:11px;font-weight:700;border:1px solid var(--border2);background:var(--surface3);color:var(--text2);flex-shrink:0;}
.alt-expl-badge.is-correct{background:var(--correct-bg);border-color:var(--correct);color:var(--correct);}
.alt-expl-opt-text{font-size:11.5px;color:var(--text3);overflow:hidden;text-overflow:ellipsis;white-space:nowrap;flex:1;}
.alt-expl-textarea{width:100%;box-sizing:border-box;padding:7px 10px;border-radius:6px;border:1px solid var(--border2);background:var(--surface3);color:var(--text);font-size:12px;line-height:1.55;resize:vertical;min-height:52px;outline:none;}
.alt-expl-textarea:focus{border-color:rgba(240,184,74,0.4);}
.alt-expl-textarea.is-correct-field,.alt-expl-textarea.is-correct{border-left:2px solid var(--correct);background:var(--correct-bg);}
.alt-expl-general-label{font-family:var(--font-mono);font-size:10px;color:var(--text3);letter-spacing:0.12em;text-transform:uppercase;margin-top:6px;}
.set-analysis-filter{display:flex;align-items:center;gap:8px;margin-bottom:10px;flex-wrap:wrap;}
.set-analysis-filter-label{font-family:var(--font-mono);font-size:10px;color:var(--text3);letter-spacing:0.08em;text-transform:uppercase;white-space:nowrap;}
.set-filter-btn{font-size:11px;font-family:var(--font-mono);padding:3px 10px;border-radius:20px;border:1px solid var(--border2);background:transparent;color:var(--text3);cursor:pointer;white-space:nowrap;}
.set-filter-btn:hover{border-color:rgba(240,184,74,0.4);color:var(--gold);}
.set-filter-btn.active{background:rgba(240,184,74,0.12);border-color:rgba(240,184,74,0.45);color:var(--gold2);font-weight:600;}
.sqc-analysis-badge{display:inline-flex;align-items:center;gap:4px;font-size:10px;font-family:var(--font-mono);padding:2px 8px;border-radius:20px;border:1px solid;white-space:nowrap;}
.sqc-analysis-badge.complete{background:rgba(232,224,200,0.08);border-color:rgba(232,224,200,0.28);color:var(--green);}
.sqc-analysis-badge.partial{background:rgba(240,184,74,0.08);border-color:rgba(240,184,74,0.28);color:var(--gold);}
.sqc-analysis-badge.none{background:rgba(232,120,88,0.07);border-color:rgba(232,120,88,0.25);color:var(--coral);}
.sqc-edit-btn{font-size:10px;font-family:var(--font-mono);padding:3px 10px;border-radius:6px;border:1px solid var(--border2);background:transparent;color:var(--text3);cursor:pointer;white-space:nowrap;}
.sqc-edit-btn:hover{border-color:rgba(240,184,74,0.45);color:var(--gold2);}
.sqc-edit-panel{display:none;flex-direction:column;gap:10px;margin-top:10px;padding:12px 14px;background:var(--surface2);border:1px solid var(--border2);border-radius:8px;}
.sqc-edit-panel.open{display:flex;}
.sqc-edit-panel-label{font-family:var(--font-mono);font-size:10px;color:var(--text3);letter-spacing:0.12em;text-transform:uppercase;padding-bottom:5px;border-bottom:1px solid var(--border);}


/* ── doubt card redesign ── */
.doubt-q-card {
  position: relative;
  background: var(--surface2);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 14px 16px 12px;
  margin-bottom: 10px;
}
.doubt-q-card:last-child { margin-bottom: 0; }
.doubt-q-card-header {
  display: flex !important;
  align-items: center !important;
  justify-content: space-between !important;
  gap: 8px !important;
  padding-bottom: 10px !important;
  border-bottom: 1px solid var(--border) !important;
  margin-bottom: 0 !important;
}
.doubt-copy-btn {
  font-size: 10px !important;
  font-family: var(--font-mono) !important;
  padding: 3px 10px !important;
  border-radius: 6px !important;
  border: 1px solid var(--border2) !important;
  background: transparent !important;
  color: var(--text2) !important;
  cursor: pointer !important;
  white-space: nowrap !important;
  transition: border-color .15s, color .15s !important;
}
.doubt-copy-btn:hover { border-color: var(--gold) !important; color: var(--gold) !important; }
.doubt-remove-btn {
  position: static !important;
  width: 22px !important; height: 22px !important;
  border-radius: 6px !important;
  display: inline-flex !important;
  align-items: center !important;
  justify-content: center !important;
  flex-shrink: 0 !important;
  font-size: 11px !important;
  cursor: pointer !important;
  background: transparent !important;
  border: 1px solid var(--border2) !important;
  color: var(--text3) !important;
  transition: all .15s !important;
}
.doubt-remove-btn:hover { border-color: #e55 !important; color: #e55 !important; }

/* footer botões */
.dq-btn {
  font-size: 11px;
  font-family: var(--font-mono);
  padding: 4px 12px;
  border-radius: 6px;
  border: 1px solid var(--border2);
  background: transparent;
  color: var(--text2);
  cursor: pointer;
  transition: all .15s;
  letter-spacing: .03em;
  white-space: nowrap;
}
.dq-btn:hover, .dq-btn.active { border-color: var(--gold); color: var(--gold); background: rgba(255,200,0,.07); }

/* reveal box */
.dq-reveal { margin-top: 0; overflow: hidden; transition: all .2s ease; }
.dq-reveal:not(:empty) { margin-top: 10px; }

.dq-gab-reveal {
  padding: 12px 14px;
  border-radius: 10px;
  background: var(--surface3, rgba(255,255,255,.04));
  border: 1px solid var(--border);
  animation: fadeUp .18s ease both;
}
.dq-gab-label { font-size: 10px; text-transform: uppercase; letter-spacing: .1em; color: var(--text3); margin-bottom: 4px; }
.dq-gab-letter { font-family: var(--font-mono); font-size: 28px; font-weight: 800; color: var(--gold); line-height: 1; }
.dq-gab-text { font-size: 12.5px; color: var(--text2); margin-top: 4px; }

.dq-anal-reveal {
  padding: 12px 14px;
  border-radius: 10px;
  background: var(--surface3, rgba(255,255,255,.04));
  border: 1px solid var(--border);
  animation: fadeUp .18s ease both;
}
.dq-anal-title { font-size: 10px; text-transform: uppercase; letter-spacing: .1em; color: var(--text3); margin-bottom: 8px; }
.dq-anal-body { font-size: 13px; color: var(--text1); line-height: 1.7; white-space: pre-wrap; word-break: break-word; }
.dq-no-data { font-size: 12px; color: var(--text3); font-style: italic; }

/* ── ⋯ button ── */
.doubt-set-menu-btn {
  width: 28px; height: 28px;
  border-radius: 8px;
  border: 1px solid var(--border2);
  background: transparent;
  color: var(--text2);
  cursor: pointer;
  font-size: 16px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
  transition: color .15s, border-color .15s;
  padding: 0;
  letter-spacing: 2px;
  line-height: 1;
}
.doubt-set-menu-btn:hover { color: var(--gold); border-color: var(--gold); }

/* ── dropdown ── */
.doubt-set-dd {
  position: fixed;
  z-index: 9999;
  background: var(--surface2);
  border: 1px solid rgba(255,200,0,.4);
  border-radius: 12px;
  padding: 6px;
  min-width: 200px;
  box-shadow: 0 8px 32px rgba(0,0,0,.7);
}
.doubt-set-dd button {
  display: flex; align-items: center; gap: 9px;
  width: 100%; padding: 8px 12px;
  border: none; background: none;
  color: var(--text1); font-size: 13px; cursor: pointer;
  border-radius: 8px; text-align: left; white-space: nowrap;
  transition: background .12s; font-family: var(--font-body);
}
.doubt-set-dd button:hover { background: rgba(255,200,0,.09); color: var(--gold); }
.doubt-set-dd hr { border: none; border-top: 1px solid var(--border); margin: 4px 0; }
